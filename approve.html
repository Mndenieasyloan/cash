<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mndeni Easy Loans - Agreement Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: #f0f0f0;
            min-height: 100vh;
            padding: 20px;
        }
        
        .input-container {
            max-width: 800px;
            margin: 0 auto 30px;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .input-container h1 {
            color: #0d7377;
            margin-bottom: 20px;
            text-align: center;
            font-size: 24px;
        }
        
        .input-container p {
            margin-bottom: 15px;
            color: #555;
        }
        
        .format-example {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            border-left: 4px solid #0d7377;
        }
        
        .input-container textarea {
            width: 100%;
            height: 280px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            resize: vertical;
            margin-top: 15px;
        }
        
        .input-container textarea:focus {
            outline: none;
            border-color: #0d7377;
            box-shadow: 0 0 0 3px rgba(13, 115, 119, 0.1);
        }
        
        .btn-container {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            justify-content: center;
        }
        
        .btn {
            padding: 14px 35px;
            font-size: 15px;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #0d7377;
            color: white;
        }
        
        .btn-primary:hover {
            background: #095456;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #f5c518;
            color: #333;
        }
        
        .btn-secondary:hover {
            background: #e0b315;
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        /* PDF Document Container */
        .pdf-document {
            display: none;
            font-family: Arial, sans-serif;
            color: #333;
        }
        
        .pdf-document.visible {
            display: block;
            margin: 30px auto;
            width: fit-content;
        }
        
        /* A4 Page - exact dimensions for PDF */
        .a4-page {
            width: 210mm;
            height: 297mm;
            padding: 12mm 15mm;
            background: white;
            box-shadow: 0 0 25px rgba(0,0,0,0.15);
            margin-bottom: 25px;
            position: relative;
            overflow: hidden;
        }
        
        /* Header Section */
        .header-section {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 3px;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .ncr-logo {
            height: 20px;
            width: auto;
        }
        
        .sa-coat-of-arms {
            height: 20px;
            width: auto;
        }
        
        .company-info {
            text-align: right;
            font-size: 11pt;
            line-height: 1.3;
        }
        
        .company-info .ncr-reg {
            color: #0d7377;
            font-weight: bold;
        }
        
        .company-info .legal-reg {
            color: #c41e3a;
            font-weight: bold;
        }
        
        .company-info a {
            color: #0d7377;
            text-decoration: underline;
        }
        
        .company-info .date-line {
            font-weight: bold;
            margin-top: 2px;
        }
        
        .small-coat {
            height: 22px;
            margin-bottom: 2px;
        }
        
        /* Mndeni Logo */
        .mndeni-logo-section {
            margin: 3px 0;
        }
        
        .mndeni-logo {
            font-size: 32pt;
            font-weight: bold;
            color: #0d7377;
            letter-spacing: -2px;
            line-height: 1;
        }
        
        .mndeni-logo span {
            color: #f5c518;;
        }
        
        .barcode {
            margin-top: 2px;
            height: 18px;
            width: 140px;
            background: repeating-linear-gradient(
                90deg,
                #000 0px, #000 2px,
                transparent 2px, transparent 4px,
                #000 4px, #000 5px,
                transparent 5px, transparent 8px,
                #000 8px, #000 10px,
                transparent 10px, transparent 11px,
                #000 11px, #000 12px,
                transparent 12px, transparent 15px
            );
        }
        
        .contract-info {
            font-weight: bold;
            margin: 19px 0;
            font-size: 8pt;
        }
        
        .main-title {
            text-align: center;
            font-size: 13pt;
            font-weight: bold;
            color: #0d7377;
            margin: 16px 0;
            text-decoration: underline;
        }
        
        .parties-section {
            text-align: center;
            margin: 14px 0;
            font-size: 8.5pt;
        }
        
        .parties-section h3 {
            color: #333;
            margin: 8px 0 2px;
            font-size: 8.5pt;
        }
        
        .parties-section .company-name {
            color: #0d7377;
            font-weight: bold;
        }
        
        .parties-section .borrower-info {
            color: #0d7377;
            font-weight: bold;
        }
        
        .parties-section .mndeni-highlight {
            color: #f5c518;
            font-weight: bold;
        }
        
        .intro-text {
            margin: 8px 0;
            text-align: left;
            font-size: 8.5pt;
        }
        
        .intro-text p {
            margin-bottom: 5px;
        }
        
        /* Loan Table */
        .loan-table {
            width: 100%;
            border-collapse: collapse;
            margin: 6px 0;
        }
        
        .loan-table th {
            background: #0d7377;
            color: white;
            padding: 5px 6px;
            text-align: center;
            font-size: 8.5pt;
        }
        
        .loan-table td {
            padding: 5px 6px;
            text-align: center;
            border: 1px solid #ddd;
            font-weight: bold;
            font-size: 8.5pt;
        }
        
        /* Section Styling */
        .section-title {
            color: #0d7377;
            font-weight: bold;
            margin: 9px 0 3px;
            font-size: 9.5pt;
        }
        
        .section-content {
            margin: 18px 0;
            text-align: justify;
            font-size: 8.5pt;
            line-height: 1.5;
        }
        
        .section-content p {
            margin-bottom: 4px;
        }
        
        /* Signature Section */
        .signature-title {
            color: #0d7377;
            font-weight: bold;
            font-size: 9.5pt;
            margin: 10px 0 3px;
        }
        
        .signatures-label {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 8.5pt;
        }
        
        .signature-section {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
        }
        
        .signature-box {
            width: 45%;
        }
        
        .signature-box h4 {
            color: #0d7377;
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 8.5pt;
        }
        
        .lender-signature-img {
            height: 35px;
            width: auto;
            display: block;
            margin-bottom: 2px;
        }
        
        .signature-line {
            border-bottom: 1px solid #333;
            margin-bottom: 3px;
            height: 30px;
            display: flex;
            align-items: flex-end;
            padding-bottom: 2px;
        }
        
        .signature-label {
            font-size: 8pt;
        }
        
        .name-line {
            margin-top: 6px;
        }
        
        .lender-name-handwritten {
            font-family: 'Arial, sans-serif;
            font-size: 14pt;
            color: #0d7377;
        }
        
        .date-line-sig {
            margin-top: 4px;
            font-size: 8.5pt;
        }
        
        .bullet-item {
            margin-left: 15px;
            margin-top: 3px;
            font-size: 8.5pt;
        }
        
        /* Page footer */
        .page-footer {
            position: absolute;
            bottom: 8mm;
            left: 15mm;
            right: 15mm;
            text-align: center;
            font-size: 7pt;
            color: #999;
            border-top: 1px solid #ddd;
            padding-top: 5px;
        }
        
        /* Print Styles */
        @media print {
            body {
                background: white;
                padding: 0;
                margin: 0;
            }
            .input-container {
                display: none !important;
            }
            .pdf-document {
                display: block !important;
            }
            .a4-page {
                box-shadow: none !important;
                margin: 0 !important;
                page-break-after: always !important;
                page-break-inside: avoid !important;
            }
        }

        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-overlay.visible {
            display: flex;
        }

        .loading-box {
            background: white;
            padding: 30px 50px;
            border-radius: 12px;
            text-align: center;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #ddd;
            border-top-color: #0d7377;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-box">
            <div class="spinner"></div>
            <p>Generating PDF...</p>
        </div>
    </div>

    <div class="input-container">
        <h1>Mndeni Easy Loans - Agreement Generator</h1>
        <p><strong>Paste all applicant details below in this exact format:</strong></p>
        <div class="format-example">
            Your full name<br>
            Janine sauls<br><br>
            Loan Amount Needed<br>
            30000<br><br>
            Loan Terms/Duration<br>
            48 months<br><br>
            Id Number<br>
            8510220194088<br><br>
            Account No: For Pay Out<br>
            51025116398
        </div>
        <textarea id="inputData" placeholder="Paste all the applicant details here exactly as shown above..."></textarea>
        <div class="btn-container">
            <button class="btn btn-primary" onclick="generateDocument()">Generate Agreement</button>
            <button class="btn btn-secondary" onclick="downloadPDF()" id="downloadBtn">Download PDF</button>
        </div>
    </div>

    <div class="pdf-document" id="pdfDocument">
        <!-- ==================== PAGE 1 ==================== -->
        <div class="a4-page" id="page1">
            <div class="header-section">
                <div class="logo-section">
                    <img src="image/img14.jpg" alt="NCR Logo" class="ncr-logo" crossorigin="anonymous">
                    <img src="image/img16.jpg" alt="SA Coat of Arms" class="sa-coat-of-arms" crossorigin="anonymous">
                </div>
                <div class="company-info">
                    <img src="image/img18.jpg" alt="SA Coat of Arms" class="small-coat" crossorigin="anonymous">
                    <div><span class="ncr-reg">NCR Reg No:</span> NCRCP19616 / <span class="legal-reg">Legal Reg No:</span> 2024/157205/07</div>
                    <div>12 Shopping Centre Rank Road Nqutu 3135,</div>
                    <div>South Africa Tel: +27 69 560 3765</div>
                    <div><a href="mailto:mndenieasyloan@aol.com">mndenieasyloan@aol.com</a></div>
                    <div class="date-line">Date: <span id="docDate"></span></div>
                </div>
            </div>

            <div class="mndeni-logo-section">
                <div class="mndeni-logo">Mndeni<span>.</span></div>
                <div class="barcode"></div>
            </div>
            
            <div class="contract-info">
                <div>CONTRACT NO: <span id="contractNo"></span> &nbsp;&nbsp;&nbsp; STATUS: APPROVED & EXECUTABLE</div>
                <div>EFFECTIVE DATE: <span id="effectiveDate"></span></div>
            </div>

            <h1 class="main-title">LOAN AGREEMENT FOR APPROVED LOAN</h1>

            <div class="parties-section">
                <h3>BETWEEN THE PARTIES: THE LENDER (MNDENI):</h3>
                <div><span class="company-name">Mndeni Easy Loans (Registration No: [NCRCP19616]</span></div>
                <div><strong>Principal Place of Business: 12 Shopping Centre, Rank Road, Nqutu, 3135</strong></div>
                <div><strong>Contact: mndenieasyloan@aol.com</strong></div>
                <div>(Hereinafter referred to as the <strong>Lender: <span class="mndeni-highlight">Mndeni</span></strong>.)</div>
                
                <h3 style="margin-top: 6px;">& THE BORROWER (YOU):</h3>
                <div class="borrower-info">Full Name: <span id="borrowerName"></span> -- S.A ID Number: <span id="borrowerId"></span></div>
                <div class="borrower-info">Designated Account for Disbursement & Repayment: <span id="borrowerAccount"></span></div>
                <div>(Hereinafter referred to as the "Borrower (YOU)")</div>
            </div>

            <div class="intro-text">
                <p>The Lender (Mndeni) and the Borrower (YOU) are collectively referred to as the "Parties."</p>
                <p>A. The Borrower (YOU) has submitted an application for a credit facility.</p>
                <p>B. The Lender (Mndeni), having assessed said application, hereby extends a formal offer of credit on the terms and conditions set forth herein.</p>
                <p><strong>NOW THEREFORE,</strong> in consideration of the mutual promises and covenants contained herein, the Parties agree as follows: Repayment Plan below</p>
            </div>

            <table class="loan-table">
                <thead>
                    <tr>
                        <th>Loan Amount</th>
                        <th>Loan Duration</th>
                        <th>Monthly Repayment</th>
                        <th>Loan Interest</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td id="loanAmount"></td>
                        <td id="loanDuration"></td>
                        <td id="monthlyRepayment"></td>
                        <td>5% Per Annum</td>
                    </tr>
                </tbody>
            </table>

            <div class="section-title">SECTION 1: LOAN FACILITY & DISBURSEMENT</div>
            <div class="section-content">
                <p>1.1 <strong>Principal Sum.</strong> The Lender (Mndeni) hereby agrees to disburse to the Borrower (YOU) a loan in the principal amount of <strong>(<span id="principalAmount"></span>)</strong>.</p>
                <p>1.2 <strong>Interest Rate.</strong> The outstanding principal balance shall accrue interest at a fixed, favorable rate of <strong>five percent (5%) per annum</strong>, calculated from the date of disbursement until full and final settlement.</p>
            </div>

            <div class="section-title">2.1 Low Credit Score UPGRADE Deposit</div>
            <div class="section-content">
                <p>Because your current credit score is low, a <strong>once-off, fully refundable credit Transfer UPGRADE deposit of R210</strong> is required before your loan can be released.</p>
                <p>This deposit secures a temporary Transfer Authorization, which facilitates an enhanced credit assessment and improves your positioning for loan approval.</p>
                <p>The deposit is fully refundable upon completion of the process and is designed specifically to support applicants with recent credit upgrades.</p>
            </div>
            
            <div class="page-footer">Page 1 of 4 | Mndeni Easy Loans Loan Agreement</div>
        </div>

        <!-- ==================== PAGE 2 ==================== -->
        <div class="a4-page" id="page2">
            <div class="section-title">2.2 Refund Guarantee (30-Minute Refund)</div>
            <div class="section-content">
                <p>If the credit UPGRADE process is completed and loan is transferred all fee paid and this <strong>full R210 deposit is refunded within 30 minutes</strong>. No delays. No hidden conditions.</p>
                <p>All refunds are processed via <strong>EFT directly to the client's nominated bank account</strong>.</p>
            </div>

            <div class="section-title">SECTION 3: REPAYMENT SCHEDULE</div>
            <div class="section-content">
                <p>3.1 <strong>Installment Plan.</strong> The Borrower (YOU) agrees to repay the Loan through <strong><span id="repaymentMonths"></span> on a Installment of <span id="installmentAmount"></span></strong> (RANDS) each Months.</p>
                <p>3.2 <strong>Payment Date.</strong> Installments shall be debited automatically on the <strong>Borrower (YOU)'s preferred day, the day "chosen below" of each month,</strong> commencing one calendar month from the date of loan disbursement.</p>
                <p>3.3 <strong>Prepayment Privilege.</strong> The Borrower (YOU) retains the unequivocal right to settle the outstanding balance, in part or in full, at any time prior to the scheduled maturity date <strong>without incurring any prepayment penalty or fee.</strong></p>
            </div>

            <div class="section-title">SECTION 4: DEBIT ORDER AUTHORIZATION</div>
            <div class="section-content">
                <p>4.1 The Borrower (YOU) hereby irrevocably authorizes the Lender (Mndeni) (and its appointed agents) to issue and deliver payment instructions to the Borrower (YOU)'s bank for the collection of all amounts due under this Agreement via direct debit.</p>
                <p>4.2 This authority shall remain in full force and effect until the Lender (Mndeni) receives written notice of its cancellation from the Borrower (YOU), which notice shall be provided no less than 20 business days before the next debit date and shall not affect the Borrower (YOU)'s liability for any amounts already due or which may become due.</p>
            </div>

            <div class="section-title">STANDING DEBIT ORDER AUTHORIZATION</div>
            <div class="section-content">
                <p>I/We, <strong><span id="debitAuthName"></span></strong>, hereby authorize Mndeni Easy Loans (or its appointed agent) to draw against my/our account held at the bank specified below, the monthly installments as specified in Section 3 of this Agreement.</p>
                <p><strong>Account Number:</strong> <span id="debitAccountNo"></span> &nbsp;&nbsp;&nbsp; <strong>Bank Name:</strong> &nbsp;&nbsp;&nbsp; <strong>Debit Amount for Monthly Repayment Only:</strong> <span id="debitAmount"></span></p>
                <p><strong>Debit Day:</strong> The _____ day of each month, commencing. <strong>This mandate shall remain in effect until the full loan obligation is settled and we will provide written revocation, subject to the terms of this Agreement.</strong></p>
                <p><strong>Sign Here to Authorize Debit Order</strong> _________________________ on this _ <span id="signDate"></span>. <strong>Borrower (YOU)'s</strong></p>
            </div>

            <div class="section-title">SECTION 5: CREDIT ENHANCEMENT COVENANT</div>
            <div class="section-content">
                <p>5.1 The Borrower (YOU) acknowledges that this Agreement is part of a <strong>constructive credit-building program.</strong> The Lender (Mndeni), with the Borrower (YOU)'s consent, may report positive repayment performance to major credit bureaus, thereby assisting the Borrower (YOU) in establishing a stronger financial profile for future opportunities.</p>
            </div>

            <div class="page-footer">Page 2 of 4 | Mndeni Easy Loans Loan Agreement</div>
        </div>

        <!-- ==================== PAGE 3 ==================== -->
        <div class="a4-page" id="page3">
            <div class="section-title">SECTION 6: DEFAULT AND REMEDIES</div>
            <div class="section-content">
                <p>6.1 <strong>Event of Default.</strong> A default shall occur if the Borrower (YOU) fails to remit any monthly installment for a period exceeding <strong>thirty-one (31) days</strong> from its due date, becomes insolvent, breaches any material term of this Agreement, or if any representation or warranty is found to be false.</p>
                <p>6.2 <strong>Consequences of Default.</strong> Upon default, the Lender (Mndeni) reserves the right to: (i) declare the entire outstanding balance immediately due and payable; (ii) forfeit the refundable security deposit; (iii) pursue all available legal remedies to recover the debt; and (iv) report the default to registered credit bureaus.</p>
                <p>6.3 <strong>Grace Period & Communication.</strong> The Lender (Mndeni) encourages proactive communication in case of financial difficulty. Contacting our offices <strong>prior to a missed payment</strong> to discuss possible arrangements is viewed favorably and may prevent a formal default classification.</p>
            </div>

            <div class="section-title">SECTION 7: ADDITIONAL TERMS AND CONDITIONS</div>
            <div class="section-content">
                <p>7.1 <strong>Entire Agreement.</strong> This Agreement constitutes the entire agreement between the parties concerning the subject matter hereof and supersedes all prior agreements, understandings, negotiations, and discussions, whether oral or written.</p>
                <p>7.2 <strong>Waiver.</strong> No waiver of any provision of this Agreement shall be effective unless in writing and signed by the party against whom enforcement is sought. No failure or delay in exercising any right shall operate as a waiver thereof.</p>
                <p>7.3 <strong>Assignment.</strong> The Borrower (YOU) may not assign or transfer any rights or obligations under this Agreement without the prior written consent of the Lender (Mndeni). The Lender (Mndeni) may assign its rights and obligations under this Agreement to any third party.</p>
                <p>7.4 <strong>Notices.</strong> All notices, requests, demands, and other communications under this Agreement shall be in writing and shall be deemed to have been duly given when delivered personally, sent by certified mail, or transmitted by electronic mail to the addresses specified in this Agreement.</p>
                <p>7.5 <strong>Force Majeure.</strong> Neither party shall be liable for any failure or delay in performing their obligations where such failure or delay results from circumstances beyond the reasonable control of that party, including but not limited to acts of God, natural disasters, war, terrorism, riots, embargoes, acts of civil or military authorities, fire, floods, accidents, strikes, or shortages of transportation, facilities, fuel, energy, labor, or materials.</p>
            </div>

            <div class="section-title">SECTION 8: CONFIDENTIALITY</div>
            <div class="section-content">
                <p>8.1 Both parties agree to maintain the confidentiality of all information exchanged in connection with this Agreement and shall not disclose such information to any third party without the prior written consent of the other party, except as required by law or regulatory authority.</p>
                <p>8.2 The Lender (Mndeni) shall comply with all applicable data protection laws and regulations in the handling of the Borrower (YOU)'s personal information.</p>
            </div>

            <div class="page-footer">Page 3 of 4 | Mndeni Easy Loans Loan Agreement</div>
        </div>
        
        <!-- ==================== PAGE 4 ==================== -->
        <div class="a4-page" id="page4">
            <div class="section-title">SECTION 10: GENERAL PROVISIONS</div>
            <div class="section-content">
                <p>10.1 <strong>Governing Law.</strong> This Agreement shall be governed by and construed in accordance with the laws of the Republic of South Africa, with specific reference to the National Credit Act (Act 34 of 2005), and the parties submit to the jurisdiction of the Magistrate's Court of KwaZulu-Natal.</p>
                <p>10.2 <strong>Amendments.</strong> Any modification or amendment to this Agreement must be documented in writing and signed by both the Lender (Mndeni) and the Borrower (YOU).</p>
                <p>10.3 <strong>Severability.</strong> If any provision of this Agreement is held to be invalid, illegal, or unenforceable by a court of competent jurisdiction, the validity, legality, and enforceability of the remaining provisions shall in no way be affected or impaired.</p>
                <p>10.4 <strong>Dispute Resolution.</strong> The parties agree to first seek an amicable resolution through good-faith negotiation. Failing this, disputes shall be submitted to mediation or, as a last resort, to the competent courts of South Africa.</p>
            </div>

            <div class="section-title">BORROWER (YOU)'S ACKNOWLEDGEMENT & ACCEPTANCE</div>
            <div class="section-content">
                <p>By signing below, the Borrower (YOU), hereby:</p>
                <div class="bullet-item">
                    <p>â€¢ Accepts the approved loan of <span id="acceptedLoanAmount"></span> under the terms stated above</p>
                </div>
            </div>

            <daiv class="signature-title">SIGNATURE FOR THE LENDER (MNDENI):</div>
            <p class="signatures-label">Signatures</p>
            
            <div class="signature-section">
    <div class="signature-box">
        <h4>Lender (Mndeni):</h4>

        <div class="signature-image">
            <img 
                src="image/img48.jpg" 
                alt="Lender Signature"
                style="max-width: 220px; height: auto;"
            >
        </div>

        <div class="name-line">
            <strong>Name:</strong> Thomas Jeffery
        </div>
    </div>
</div>

                    <div class="date-line-sig"><strong>Date:</strong> <span id="lenderSignDate"></span></div>
                </div>
                <div class="signature-box">
                    <h4>Borrower (YOU):</h4>
                    <div class="signature-line"></div>
                    <div class="signature-label"><strong>Signature:</strong> _______________________</div>
                    <div class="name-line"><strong>Name:</strong> _______________________</div>
                    <div class="date-line-sig"><strong>Date:</strong> <span id="borrowerSignDate"></span></div>
                </div>
            </div>

            <div style="margin-top: 25px; padding-top: 12px; border-top: 2px solid #0d7377;">
                <div style="text-align: center; margin-bottom: 12px;">
                    <div class="mndeni-logo" style="font-size: 24pt;">Mndeni<span>.</span></div>
                    <p style="font-size: 8pt; color: #666; margin-top: 3px;"><em>"Empowering Financial Growth Through Responsible Lending"</em></p>
                </div>
                <p style="font-size: 7.5pt; text-align: center; color: #666;">
                    This document is a legally binding agreement. Please retain a copy for your records.<br>
                    For any queries, contact us at mndenieasyloan@aol.com or +27 69 560 3765
                </p>
            </div>
            
            <div class="page-footer">Page 4 of 4 | Mndeni Easy Loans Loan Agreement | Contract No: <span id="contractNoFooter"></span></div>
        </div>
    </div>

    <script>
        function parseInputData(text) {
            const lines = text.trim().split('\n').map(line => line.trim()).filter(line => line);
            const data = {
                fullName: '',
                loanAmount: 0,
                loanDuration: 0,
                idNumber: '',
                accountNo: ''
            };

            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].toLowerCase();
                
                if (line.includes('full name') || line.includes('your full name')) {
                    if (i + 1 < lines.length && !lines[i + 1].toLowerCase().includes('loan') && !lines[i + 1].toLowerCase().includes('id') && !lines[i + 1].toLowerCase().includes('account')) {
                        data.fullName = lines[i + 1];
                    }
                }
                
                if (line.includes('loan amount')) {
                    if (i + 1 < lines.length) {
                        const amount = parseFloat(lines[i + 1].replace(/[^0-9.]/g, ''));
                        if (!isNaN(amount)) {
                            data.loanAmount = amount;
                        }
                    }
                }
                
                if (line.includes('loan term') || line.includes('duration')) {
                    if (i + 1 < lines.length) {
                        const months = parseInt(lines[i + 1].replace(/[^0-9]/g, ''));
                        if (!isNaN(months)) {
                            data.loanDuration = months;
                        }
                    }
                }
                
                if (line.includes('id number') || line === 'id') {
                    if (i + 1 < lines.length) {
                        data.idNumber = lines[i + 1].replace(/[^0-9]/g, '');
                    }
                }
                
                if (line.includes('account') && (line.includes('pay out') || line.includes('payout') || line.includes('no'))) {
                    if (i + 1 < lines.length) {
                        data.accountNo = lines[i + 1].replace(/[^0-9]/g, '');
                    }
                }
            }

            return data;
        }

        function calculateMonthlyInstallment(loanAmount, months) {
            const interest = loanAmount * 0.05;
            const totalAmount = loanAmount + interest;
            return totalAmount / months;
        }

        function formatCurrency(amount) {
            return 'R' + amount.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }

        function formatDate(date) {
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            return `${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}`;
        }

        function generateContractNo(accountNo) {
            const year = new Date().getFullYear();
            const month = String(new Date().getMonth() + 1).padStart(2, '0');
            return `MEL-${year}-${month}-${accountNo}`;
        }

        function generateDocument() {
            const inputText = document.getElementById('inputData').value;
            
            if (!inputText.trim()) {
                alert('Please paste the applicant details first!');
                return;
            }

            const data = parseInputData(inputText);

            if (!data.fullName || !data.loanAmount || !data.loanDuration) {
                alert('Could not parse all required data. Please ensure you paste the data in the correct format.');
                return;
            }

            const today = new Date();
            const monthlyPayment = calculateMonthlyInstallment(data.loanAmount, data.loanDuration);
            const contractNo = generateContractNo(data.accountNo);

            // Populate all document fields
            document.getElementById('docDate').textContent = formatDate(today);
            document.getElementById('contractNo').textContent = contractNo;
            document.getElementById('contractNoFooter').textContent = contractNo;
            document.getElementById('effectiveDate').textContent = formatDate(today).toUpperCase();
            document.getElementById('borrowerName').textContent = data.fullName.toUpperCase();
            document.getElementById('borrowerId').textContent = data.idNumber;
            document.getElementById('borrowerAccount').textContent = data.accountNo;
            document.getElementById('loanAmount').textContent = formatCurrency(data.loanAmount);
            document.getElementById('loanDuration').textContent = data.loanDuration + ' Months';
            document.getElementById('monthlyRepayment').textContent = formatCurrency(monthlyPayment);
            document.getElementById('principalAmount').textContent = formatCurrency(data.loanAmount);
            document.getElementById('repaymentMonths').textContent = data.loanDuration + ' Months';
            document.getElementById('installmentAmount').textContent = formatCurrency(monthlyPayment);
            document.getElementById('debitAuthName').textContent = data.fullName.toUpperCase();
            document.getElementById('debitAccountNo').textContent = data.accountNo;
            document.getElementById('debitAmount').textContent = formatCurrency(monthlyPayment);
            document.getElementById('signDate').textContent = formatDate(today);
            document.getElementById('acceptedLoanAmount').textContent = formatCurrency(data.loanAmount);
            document.getElementById('lenderSignDate').textContent = today.toLocaleDateString('en-GB');
            document.getElementById('borrowerSignDate').textContent = today.toLocaleDateString('en-GB');

            // Show document
            document.getElementById('pdfDocument').classList.add('visible');
            document.getElementById('pdfDocument').scrollIntoView({ behavior: 'smooth' });
        }

        async function downloadPDF() {
            const element = document.getElementById('pdfDocument');
            
            if (!element.classList.contains('visible')) {
                alert('Please generate the agreement first!');
                return;
            }

            const btn = document.getElementById('downloadBtn');
            btn.disabled = true;
            document.getElementById('loadingOverlay').classList.add('visible');

            const borrowerName = document.getElementById('borrowerName').textContent;
            const filename = `Mndeni_Loan_Agreement_${borrowerName.replace(/\s+/g, '_')}.pdf`;

            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF({
                orientation: 'portrait',
                unit: 'mm',
                format: 'a4'
            });

            const pages = document.querySelectorAll('.a4-page');
            const pageWidth = 210;
            const pageHeight = 297;

            for (let i = 0; i < pages.length; i++) {
                const page = pages[i];
                
                try {
                    const canvas = await html2canvas(page, {
                        scale: 2,
                        useCORS: true,
                        allowTaint: true,
                        logging: false,
                        backgroundColor: '#ffffff',
                        width: page.offsetWidth,
                        height: page.offsetHeight
                    });

                    const imgData = canvas.toDataURL('image/jpeg', 0.95);
                    
                    if (i > 0) {
                        pdf.addPage();
                    }
                    
                    pdf.addImage(imgData, 'JPEG', 0, 0, pageWidth, pageHeight);
                } catch (error) {
                    console.error('Error rendering page', i + 1, error);
                }
            }

            pdf.save(filename);
            
            btn.disabled = false;
            document.getElementById('loadingOverlay').classList.remove('visible');
        }
    </script>
</body>
</html>
